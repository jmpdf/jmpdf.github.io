<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
        rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>projeto5</title>
    <link rel="stylesheet" href="/mystyle.css">
    <script src="https://cdn.pubnub.com/sdk/javascript/pubnub.7.2.2.min.js"></script>
</head>

<body>
    <div class="sel">
        <a href="/index.html">
            <div class="element">Inicio</div>
        </a><!--
        --><a href="subpage1.html">
            <div class="element">Atividades</div>
        </a><!--    
        --><a href="subpage2.html">
            <div class="element">pagina2</div>
        </a><!--    
        --><a href="subpage3.html">
            <div class="destaque">chatlegal</div>
        </a>
        <div class="last"></div>

    </div>
    <br><br><br>
    <form id="input-form">
        <label for="message"></label>
        <input type="text" id="message" name="message"><br><br>
        <input type="submit" value="enviar">
    </form>
    <br><br><br><br>
    <div id="messages"></div>

    <script>
        var x = 0;
        var pubnub = new PubNub({
            publishKey: 'pub-c-0d3cf572-40cd-442f-a4ea-d42c4e00782c',
            subscribeKey: 'sub-c-e28c62f0-09e9-4698-8200-73bb428dfe9a',
            userId: prompt("qual teu nome")
        })
        pubnub.subscribe({
            channels: ['ws-channel']
        })
        pubnub.addListener({
            message: payload => {
                console.log(payload)
                document.getElementById('messages').innerHTML +=
                    "<div><font color='#FF2626'>" + payload.publisher + '</font>:' + payload.message + "<br></div>";
                x++;
                if(x > 9){
                    document.getElementById('messages').firstChild.remove();
                }
            }
        })
        function sendMessage(event) {
            var inputMessage = document.getElementById('message')
            pubnub.publish({
                channel: 'ws-channel',
                message: inputMessage.value
            })
            inputMessage.value = ""
            event.preventDefault();
        }
        document.getElementById('input-form').addEventListener('submit', sendMessage);
    </script>
</body>

</html>